{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46595467-38d51347a919535f7c3759bfb';\n\nexport async function fetchImages(query, page = 1, perPage = 60) {\n  const URL = `https://pixabay.com/api/?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(URL); // Запит до API через axios\n    return {\n      images: response.data.hits,\n      totalHits: response.data.totalHits // Повертаємо загальну кількість результатів\n    };\n  } catch (error) {\n    console.error('Error:', error);\n    return { images: [], totalHits: 0 }; // У разі помилки повертаємо порожні результати\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function displayImages(images) {\n  const gallery = document.getElementById('image-gallery');\n  gallery.innerHTML = ''; // Очищення попередніх зображень\n\n  images.forEach(image => {\n    const imgElement = document.createElement('a');\n    imgElement.href = image.largeImageURL; // Для SimpleLightbox\n    imgElement.classList.add('gallery-item');\n\n    imgElement.innerHTML = `\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n      <div class=\"image-info\">\n        <p><strong>Downloads:</strong> ${image.downloads}</p>\n        <p><strong>Likes:</strong> ${image.likes}</p>\n        <p><strong>Views:</strong> ${image.views}</p>\n        \n      </div>\n    `;\n\n    gallery.appendChild(imgElement); // Додаємо новий елемент у галерею\n  });\n}\n\nexport function clearGallery() {\n  const gallery = document.getElementById('image-gallery');\n  gallery.innerHTML = ''; // Очищення вмісту галереї ..\n}\n","import { fetchImages } from './js/pixabay-api.js'; // Імпорт функції з оновленим axios\nimport { displayImages, clearGallery } from './js/render-functions.js'; // Імпорт функцій для рендерингу та очищення галереї\nimport iziToast from 'izitoast'; // Імпорт iziToast для повідомлень\nimport 'izitoast/dist/css/iziToast.min.css'; // Підключення стилів iziToast\nimport SimpleLightbox from 'simplelightbox';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0; // Для збереження загальної кількості результатів\nlet loadedHits = 0; // Для відстеження кількості завантажених результатів\nlet lightbox;\n\nconst loadMoreButton = document.createElement('button');\nloadMoreButton.textContent = 'Load more';\nloadMoreButton.style.display = 'none';\nloadMoreButton.classList.add('load-more-btn');\ndocument.body.appendChild(loadMoreButton);\n\nloadMoreButton.addEventListener('click', async function () {\n  currentPage += 1;\n  const { images } = await fetchImages(currentQuery, currentPage);\n\n  if (images.length > 0) {\n    displayImages(images);\n    loadedHits += images.length; // Оновлюємо кількість завантажених результатів\n    lightbox.refresh();\n\n    if (loadedHits >= totalHits) { // Якщо всі результати завантажені\n      loadMoreButton.style.display = 'none'; // Приховуємо кнопку\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n});\n\nconst loader = document.createElement('div');\nloader.classList.add('loader');\nloader.innerHTML = '<div class=\"lds-dual-ring\"></div>';\ndocument.body.appendChild(loader);\nloader.style.display = 'none';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const form = document.getElementById('search-form');\n  form.addEventListener('submit', async function (event) {\n    event.preventDefault();\n\n    const queryInput = document.getElementById('search-input');\n    const query = queryInput.value.trim();\n\n    if (query === '') {\n      iziToast.error({\n        title: 'Error',\n        message: 'Please enter a valid search query!',\n      });\n      return;\n    }\n\n    clearGallery();\n    currentPage = 1;\n    currentQuery = query;\n    loader.style.display = 'block';\n\n    try {\n      const { images, totalHits: hits } = await fetchImages(query, currentPage); // Отримуємо загальну кількість результатів\n      totalHits = hits; // Зберігаємо загальну кількість результатів\n      loadedHits = images.length; // Встановлюємо кількість завантажених результатів\n\n      if (images.length > 0) {\n        displayImages(images);\n        lightbox = new SimpleLightbox('.gallery a', {\n          captionsData: 'alt',\n          captionDelay: 250,\n        });\n\n        if (loadedHits < totalHits) { // Якщо є ще результати для завантаження\n          loadMoreButton.style.display = 'block';\n        } else {\n          loadMoreButton.style.display = 'none'; // Якщо всі результати завантажені\n          iziToast.info({\n            title: 'Info',\n            message: \"We're sorry, but you've reached the end of search results.\",\n          });\n        }\n      } else {\n        iziToast.error({\n          title: 'Error',\n          message: 'Sorry, no images matching your search query. Please try again!',\n        });\n        loadMoreButton.style.display = 'none';\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Something went wrong. Please try again later.',\n      });\n      console.error('Error:', error);\n    } finally {\n      loader.style.display = 'none';\n      queryInput.value = '';\n    }\n  });\n});\n\nloadMoreButton.addEventListener('click', async function () {\n  currentPage += 1;\n  const { images } = await fetchImages(currentQuery, currentPage);\n\n  if (images.length > 0) {\n    const gallery = document.querySelector('.gallery');\n    \n    // Отримуємо висоту однієї картки перед тим, як додати нові зображення\n    const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n\n    displayImages(images); // Додаємо нові зображення\n    loadedHits += images.length;\n    lightbox.refresh(); // Оновлюємо SimpleLightbox\n\n    // Плавне прокручування на дві висоти картки галереї\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth', // Плавна прокрутка\n    });\n\n    if (loadedHits >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n});\n\n"],"names":["API_KEY","fetchImages","query","page","perPage","URL","response","axios","error","displayImages","images","gallery","image","imgElement","clearGallery","currentPage","currentQuery","totalHits","loadedHits","lightbox","loadMoreButton","iziToast","loader","event","queryInput","hits","SimpleLightbox","cardHeight"],"mappings":"+vBAEA,MAAMA,EAAU,qCAET,eAAeC,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAC/D,MAAMC,EAAM,gCAAgCL,CAAO,MAAME,CAAK,iEAAiEC,CAAI,aAAaC,CAAO,GAEvJ,GAAI,CACF,MAAME,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpC,MAAO,CACL,OAAQC,EAAS,KAAK,KACtB,UAAWA,EAAS,KAAK,SAC/B,CACG,OAAQE,EAAO,CACd,eAAQ,MAAM,SAAUA,CAAK,EACtB,CAAE,OAAQ,CAAA,EAAI,UAAW,CAAC,CAClC,CACH,CCdO,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAAU,SAAS,eAAe,eAAe,EACvDA,EAAQ,UAAY,GAEpBD,EAAO,QAAQE,GAAS,CACtB,MAAMC,EAAa,SAAS,cAAc,GAAG,EAC7CA,EAAW,KAAOD,EAAM,cACxBC,EAAW,UAAU,IAAI,cAAc,EAEvCA,EAAW,UAAY;AAAA,kBACTD,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,yCAEfA,EAAM,SAAS;AAAA,qCACnBA,EAAM,KAAK;AAAA,qCACXA,EAAM,KAAK;AAAA;AAAA;AAAA,MAK5CD,EAAQ,YAAYE,CAAU,CAClC,CAAG,CACH,CAEO,SAASC,GAAe,CAC7B,MAAMH,EAAU,SAAS,eAAe,eAAe,EACvDA,EAAQ,UAAY,EACtB,CCvBA,IAAII,EAAc,EACdC,EAAe,GACfC,EAAY,EACZC,EAAa,EACbC,EAEJ,MAAMC,EAAiB,SAAS,cAAc,QAAQ,EACtDA,EAAe,YAAc,YAC7BA,EAAe,MAAM,QAAU,OAC/BA,EAAe,UAAU,IAAI,eAAe,EAC5C,SAAS,KAAK,YAAYA,CAAc,EAExCA,EAAe,iBAAiB,QAAS,gBAAkB,CACzDL,GAAe,EACf,KAAM,CAAE,OAAAL,CAAM,EAAK,MAAMT,EAAYe,EAAcD,CAAW,EAE1DL,EAAO,OAAS,IAClBD,EAAcC,CAAM,EACpBQ,GAAcR,EAAO,OACrBS,EAAS,QAAO,EAEZD,GAAcD,IAChBG,EAAe,MAAM,QAAU,OAC/BC,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,GAGP,CAAC,EAED,MAAMC,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAU,IAAI,QAAQ,EAC7BA,EAAO,UAAY,oCACnB,SAAS,KAAK,YAAYA,CAAM,EAChCA,EAAO,MAAM,QAAU,OAEvB,SAAS,iBAAiB,mBAAoB,UAAY,CAC3C,SAAS,eAAe,aAAa,EAC7C,iBAAiB,SAAU,eAAgBC,EAAO,CACrDA,EAAM,eAAc,EAEpB,MAAMC,EAAa,SAAS,eAAe,cAAc,EACnDtB,EAAQsB,EAAW,MAAM,KAAI,EAEnC,GAAItB,IAAU,GAAI,CAChBmB,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oCACjB,CAAO,EACD,MACD,CAEDP,IACAC,EAAc,EACdC,EAAed,EACfoB,EAAO,MAAM,QAAU,QAEvB,GAAI,CACF,KAAM,CAAE,OAAAZ,EAAQ,UAAWe,CAAI,EAAK,MAAMxB,EAAYC,EAAOa,CAAW,EACxEE,EAAYQ,EACZP,EAAaR,EAAO,OAEhBA,EAAO,OAAS,GAClBD,EAAcC,CAAM,EACpBS,EAAW,IAAIO,EAAe,aAAc,CAC1C,aAAc,MACd,aAAc,GACxB,CAAS,EAEGR,EAAaD,EACfG,EAAe,MAAM,QAAU,SAE/BA,EAAe,MAAM,QAAU,OAC/BC,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACrB,CAAW,KAGHA,EAAS,MAAM,CACb,MAAO,QACP,QAAS,gEACnB,CAAS,EACDD,EAAe,MAAM,QAAU,OAElC,OAAQZ,EAAO,CACda,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACjB,CAAO,EACD,QAAQ,MAAM,SAAUb,CAAK,CACnC,QAAc,CACRc,EAAO,MAAM,QAAU,OACvBE,EAAW,MAAQ,EACpB,CACL,CAAG,CACH,CAAC,EAEDJ,EAAe,iBAAiB,QAAS,gBAAkB,CACzDL,GAAe,EACf,KAAM,CAAE,OAAAL,CAAM,EAAK,MAAMT,EAAYe,EAAcD,CAAW,EAE9D,GAAIL,EAAO,OAAS,EAAG,CACrB,MAAMC,EAAU,SAAS,cAAc,UAAU,EAG3C,CAAE,OAAQgB,CAAU,EAAKhB,EAAQ,kBAAkB,wBAEzDF,EAAcC,CAAM,EACpBQ,GAAcR,EAAO,OACrBS,EAAS,QAAO,EAGhB,OAAO,SAAS,CACd,IAAKQ,EAAa,EAClB,SAAU,QAChB,CAAK,EAEGT,GAAcD,IAChBG,EAAe,MAAM,QAAU,OAC/BC,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,EAEJ,CACH,CAAC"}